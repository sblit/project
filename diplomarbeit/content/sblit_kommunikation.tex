\subsection{Allgemein}
Sblit verwendet zur Kommunikation fünf verschiedene Nachrichten:
\begin{itemize}
	\item Authentifizierungssanfrage
	\item Antwort auf eine Authentifizierungssanfrage
	\item Dateianfragen
	\item Antwort auf eine Dateianfrage
	\item Die eigentliche Übertragung der Datei
\end{itemize}
\subsection{Authentifizierungssanfrage}
Angenommen zwei Geräte eines Besitzers wollen Daten austauschen. Wie können sich diese sicher sein, dass es sich auch um das richtige Gerät handelt? Hier kommt die Authentizierung ins Spiel. Authentizitätsanfragen dienen zur Sicherstellung der Authentizität des Gerätes (im Folgenden Gerät A), mit dem ein anderes Gerät (im Folgenden Gerät B) eine Verbindung aufbaut. Dazu schickt das Gerät B zufällige Daten an Gerät A mit der Aufforderung, diese zu verschlüsseln. Die Gesamtlänge der Daten, die mit RSA-2048 verschlüsselt werden, darf maximal 128 Byte lang sein. Um Gerät A 64 Byte zur Verfügung zu stellen, beträgt die Länge der von Gerät B gesendeten Daten 64 Byte. Diese 64 Byte werden von Gerät A benötigt, um zu verhindern, dass Gerät B sich gewünschte Werte von Gerät A verschlüsseln lässt.

\subsection{Antwort auf eine Authentifizierungssanfrage}
Bevor die Daten wieder zurückgeschickt werden, müssen diese von Gerät B verschlüsselt werden. Dies geschieht mit dem Private-Key des Gerätes B. Dabei wird vorher noch ein zufälliger Wert an die empfangenen Daten angefügt, um das unter Authentifizierungsanfragen beschriebene Problem zu lösen.
Wird dieses Paket nun von Gerät B empfangen, kann der Inhalt mit dem Public-Key des Gerätes A, also dessen Adresse, entschlüsselt werden. Von den erhaltenen Daten werden die 64 Byte am Beginn mit den ursprünglich gesendeten 64 Byte verglichen. Stimmen die beiden Werte überein, kann das Gerät seine Authentizität beweisen. Stimmen diese jedoch nicht überein, handelt es sich um einen Betrüger, der offensichtlich den richtigen Private-Key zur vorgetäuschten Adresse nicht kennt.

\subsection{Dateianfrage}
Bevor eine Datei an ein anderes Gerät (im Folgenden Gerät B) verschickt wird, schickt das Gerät, das die Datei besitzt (im Folgenden Gerät A), eine Dateianfrage an das Gerät B. Dies hat 2 Gründe: Erstens muss eruiert werden, ob die Datei überhaupt von Gerät B benötigt wird, oder ob besagtes Gerät schon diese Datei besitzt. Zweitens besteht die Möglichkeit eines Konfliktes. Eine nähere Erklärung zu Konflikten finden Sie im Kapitel \nameref{Konflikt} auf Seite \pageref{Konflikt}. Daher werden sowohl der zu Sblits Hauptordner relative Dateipfad, als auch ein Versionsverlauf mit allen Hashes der Datei seit der letzten Version, die auf allen Geräten verteilt war, an das Gerät B versendet. 

\subsection{Antwort auf eine Dateianfrage}
Die Antwort auf eine Dateianfrage beinhaltet den Pfad der Datei, ein Feld in dem steht, ob die Datei benötigt wird und den letzten Hashwert in der Dateianfrage. Nach Empfang der Dateianfrage wird zunächst geprüft, ob die Datei vorhanden und in der aktuellsten Version ist.  Ist die lokale Datei nicht aktuell, wird das Feld, in dem steht, ob das File benötigt wird, auf den Hexadezimalwert 0x01 gesetzt. Ist die Datei auf dem aktuellsten Stand, wird besagtes Feld auf den Hexadezimalwert 0x00 gesetzt. Außerdem wird überprüft, ob ein Konflikt aufgetreten ist. Die Konflikterkennung finden Sie im Kapitel \nameref{Konflikterkennung} auf der Seite \pageref{Konflikterkennung}.
Nach Empfang der Antwort wird zunächst überprüft, ob die Datei benötigt wird. Außerdem wird zusätzlich überprüft, ob der Hashwert der Datei mit dem erhaltenen Pfad übereinstimmt. Stimmt der Hashwert in der Anfrage nicht mit dem aktuellen Hashwert überein, wird die Antwort verworfen. Stimmt dieser jedoch überein kann die Datei nun im nächsten Schritt verschickt werden.

\subsection{Die eigentliche Übertragung der Datei}
Bei der eigentlichen Übertragung der Datei werden folgenden Daten mit der Datei mitgesendet: die Geräte, auf denen die neuste Version schon vorhanden ist, der Pfad, in dem die Datei gespeichert ist und der Hash der aktuellen Datei. Um einem Gerät, das die neuste Version schon besitzt keine unnötige Dateianfrage zu schicken, werden die Geräte, die diese Version schon besitzen, ebenfalls mit einer Datei mitgeschickt. Der Pfad wird mitgeschickt, um die Datei auf dem zu synchronisierenden Gerät am gleichen relativen Ort zu speichern, wie auf dem Gerät, von dem die Datei kommt. Um sicherzustellen, dass die Datei auch so ankommt, wie sie verschickt wird, wird ein Hash der Datei mitgesendet. Verhasht man die Datei, muss das Ergebnis mit dem mitgeschickten Hash übereinstimmen. Andernfalls entsteht ein Übertragungsfehler und die Datei muss neu gesendet werden.
Authentizitätsanfragen dienen zur Sicherstellung der Authentizität des Gerätes (im Folgenden Gerät A), mit dem ein anderes Gerät (im Folgenden Gerät B) eine Verbindung aufbaut. Dazu schickt das Gerät B zufällige Daten an Gerät A mit der Aufforderung, diese zu verschlüsseln. Die Länge der gesendeten Daten beträgt dabei 64 Byte, um Gerät A weitere 64 Byte zur Verfügung zu stellen, um zu verhindern, dass Gerät B sich einen bestimmten Wert von Gerät A verschlüsseln lässt.
